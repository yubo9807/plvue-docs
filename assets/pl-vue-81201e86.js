var He=Object.defineProperty;var Be=(e,t,n)=>t in e?He(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var h=(e,t,n)=>(Be(e,typeof t!="symbol"?t+"":t,n),n);function me(){return Number((Math.random()+"").slice(2)).toString(32)}function L(...e){console.warn(...e)}function p(e){return e.length}function ue(e){return Object.prototype.toString.call(e).slice(8,-1).toLowerCase()}function Ve(e){return e.toString().slice(0,5)==="class"}function j(e){return["object","array"].includes(ue(e))}function Ue(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function ae(e,t){if(j(e)&&j(t)){const n=Object.keys(e),r=Object.keys(t);if(p(n)!==p(r))return!1;for(const o of n)if(!r.includes(o)||!ae(e[o],t[o]))return!1;return!0}else return e===t}function fe(){return typeof window=="object"}function R(e){return ue(e)==="object"}function Z(e){return Array.isArray(e)}function O(e){return typeof e=="string"}function m(e){return typeof e=="function"}function H(e){Promise.resolve().then(e)}function w(e,t={}){const n=new WeakMap,r=["null","regexp","date","weakset","weakmap"],o=Object.assign({function(s){const u=function(...c){return s.apply(this,c)};return u.prototype=i(s.prototype),u},set(s){const u=new Set;for(const c of s)u.add(i(c));return u},map(s){const u=new Map;for(const[c,a]of s.entries())u.set(c,i(a));return u}},t);function i(s){if(s instanceof HTMLElement)return s.cloneNode(!0);const u=ue(s);if(!["object","function"].includes(typeof s)||r.includes(u))return s;if(n.has(s))return n.get(s);if(o[u])return o[u](s);const c=Z(s)?[]:{};Object.setPrototypeOf(c,Object.getPrototypeOf(s)),n.set(s,c);for(const a in s)s.hasOwnProperty(a)&&(c[a]=i(s[a]));return c}return i(e)}function B(e,t){return Object.assign({},e,t)}function d(e,t,n){let r=0;for(;r<e.length;){if(e.hasOwnProperty(r)){const o=e[r];t.apply(n,[o,r,n])}r++}}let $=null;const V=new WeakMap;function v(e){$=e,e(),$=null}function Ke(e){const t=V.get(e)||[],n=t.some(r=>$===r);$&&!n&&(t.push($),V.set(e,t))}function ye(e){const t=V.get(e);t&&d(t,(n,r)=>{n()===!0&&(t.splice(r,1),V.set(e,t))})}const ze=new WeakMap,ne=new WeakMap,U={RAW:Symbol("__v_raw"),IS_READONLY:Symbol("__v_isReadonly")};function I(e){if(!j(e)||Object.isFrozen(e))return L(`lue cannot be made reactive: ${e}`),e;if(ze.get(e))return e;let t=null;return new Proxy(e,{get(n,r,o){if(r===U.RAW)return n;const i=Reflect.get(n,r,o);return Ke(n),j(i)?I(i):i},set(n,r,o,i){if(n[U.IS_READONLY]||Reflect.get(n,r,i)===o)return!0;const u=Reflect.set(n,r,o,i),c=ne.get(n)||new Set;c.add(r);const a=c.size;return ne.set(n,c),H(()=>{u&&a===1&&ye(n),ne.delete(n)}),u},deleteProperty(n,r){const o=Reflect.get(n,r),i=Ue(n,r),s=Reflect.deleteProperty(n,r);return t=r,H(()=>{i&&s&&o!==void 0&&r===t&&(ye(n),t=null)}),s}})}function Ye(e){return R(e)&&!!e[U.RAW]}function le(e){return Ye(e)?e[U.RAW]:e}function Ge(e){const t={value:e},n=I(t);function r(){return n.value}function o(i){n.value=i}return[r,o,t]}const je="__v_isRef";var gt;class Je{constructor(t){h(this,gt,!0);h(this,"_rawValue");h(this,"_value");h(this,"getSignal");h(this,"setSignal");const[n,r,o]=Ge(t);this._rawValue=o,this.getSignal=n,this.setSignal=r,this._value=n()}get value(){return this.getSignal()}set value(t){this.setSignal(t)}}gt=je;function Qe(e=void 0){return new Je(e)}class Xe{constructor(t){h(this,"fn");this.fn=t}}var bt;class ge{constructor(t,n){h(this,"__v_isReadonly",!0);h(this,bt,!0);h(this,"_cacheable",!0);h(this,"_dirty",!0);h(this,"computed");h(this,"_setter");this.computed=new Xe(t),this._setter=n}get value(){return this.computed.fn()}set value(t){this._setter?this._setter(t):L("Write operation failed: computed value is readonly")}}bt=je;function Rt(e){return m(e)?new ge(e):new ge(e.get,e.set)}function Ze(e,t,n={}){let r=!1;if(r)return;const o=e();n.immediate&&t(o,void 0);let i=w(o),s=!0;return v(()=>{if(r)return!0;const u=e();if(j(u)){n.deep&&!ae(u,i)&&(t(u,i),i=w(u));return}if(s){s=!1;return}u!==i&&(t(u,i),i=u)}),()=>{r=!0}}function N(e){return["string","number"].includes(typeof e)&&e!==""}function Ce(e){return!/^on/.test(e)}function Oe(e){return R(e)&&(O(e.tag)||P(e.tag))}function b(e){return m(e)&&!P(e)}function Ne(e){return Ve(e)&&e.prototype&&e.prototype.render}function Pe(e){return[void 0,null,"",!0,!1].includes(e)}function $e(...e){return e.filter(n=>N(n)).join(" ").trim().replace(/\s+/," ")}function ee(e){return document.createTextNode(e)}function x(e,t){e.appendChild(t)}function y(e,t,...n){const r={tag:e,attrs:t||{},children:n};return b(r.tag)&&p(r.children)===0&&r.attrs.children&&(r.children=r.attrs.children),r}function T({children:e}){return e}const K=Symbol("Fragment");T.prototype[K]=K;function P(e){return m(e)&&e.prototype&&e.prototype[K]===K}const z=new WeakMap;function _e(e,t=[]){return d(e,n=>{R(n)&&(b(n.tag)?(t.push({comp:n.tag,props:B(n.attrs,{children:e})}),d(n.children,r=>{b(r)&&t.push({comp:r,props:{}})})):N(n.tag)&&_e(n.children,t))}),t}function pe(e,t=[]){const n=z.get(e)||[];return t.push(...n),d(n,r=>{const o=pe(r.comp);t.push(...o)}),t}let Y=null;function ve(e){Y=e}let be=null;function et(e,t){Y=e,"ref"in t&&(t.ref.value=be),be=null}let de=!1;function we(e){de=e}const Re=new WeakMap;function Se(e){const t=pe(e).map(r=>r.comp);t.unshift(e);const n=[];d(t,r=>{const o=Re.get(r)||[];n.push(...o),Re.delete(r)}),d(n,r=>r())}const G=new WeakMap;function tt(e){if(de)return;const t=G.get(Y)||[];t.some(r=>r===e)||(t.push(e),G.set(Y,t))}function ke(e){const t=pe(e).map(r=>r.comp);t.unshift(e);const n=[];d(t,r=>{const o=G.get(r)||[];n.push(...o),G.delete(r)}),d(n,r=>r())}function C(e,t,n){if(O(e))return Fe(e,t,n);if(m(e)){if(e=e,P(e))return te(n);if(ve(e),Ne(e)){const i=new e({...t,children:n});e=i.render.bind(i)}e=e;const r=B(t,{children:n}),o=e(r);return et(e,t),N(o)?ee(o):(z.set(e,_e([o,...o.children])),C(o.tag,o.attrs,o.children))}}function Fe(e,t={},n=[""]){if(m(e)&&P(e))return C(e,t,n);const r=document.createElement(e);d(n,o=>{if(m(o)){const i=te([o]);x(r,i)}else We(r,o)});for(const o in t)nt(r,o,t[o]);if(t.style&&R(t.style))for(const o in t.style){const i=t.style[o];m(i)?v(()=>r.style[o]=i()):r.style[o]=i}return r}function nt(e,t,n){if(t==="ref"&&R(n)){n.value=e;return}if(t==="created"&&m(n)){n(e);return}let r=o=>e[t]=o;t==="className"?r=o=>e[t]=$e(...[o].flat()):t.startsWith("data-")&&(r=o=>e.dataset[t.slice(5)]=o),Ce(t)&&m(n)?v(()=>r(n())):r(n)}function te(e){const t=document.createDocumentFragment();return d(e,n=>{m(n)?ot(t,n):We(t,n)}),t}function We(e,t){if(!Pe(t)){if(N(t)){const n=ee(t);n.nodeValue=t,x(e,n);return}if(Z(t)){const n=te(t);x(e,n);return}if(Oe(t)){const n=Fe(t.tag,t.attrs,t.children);x(e,n);return}if(R(t)&&b(t.tag)){const n=C(t.tag,t.attrs,t.children);x(e,n);return}L(`render: 不支持 ${t} 值渲染`)}}function Me(e){if(N(e))return ee(e);if(Oe(e)||R(e)&&b(e.tag))return C(e.tag,e.attrs,e.children)}function rt(e,t){let n=0,r=p(e)-1;for(;n<=r;){const o=Math.ceil((n+r)/2),i=e[o];if(t===i.key)return o;t<i.key?r=o-1:t>i.key&&(n=o+1)}return-1}function ot(e,t){let n=[],r=!0,o=null;const i=ee("");x(e,i),v(()=>{let s=t();if(s&&R(s)&&P(s.tag)){L("不支持响应式节点片段渲染");return}Z(s)||(s=[s]),s=s.filter(c=>!Pe(c));let u=0;for(;u<p(s);){let c=s[u];const a=rt(n,u);if(a>=0){if(ae(c,n[a].tree)){u++;continue}const f=Me(c);if(!f){s.splice(a,1),u++;continue}const M=n[a].tree;if(b(M.tag)&&Se(M.tag),n[a].node.parentElement.replaceChild(f,n[a].node),b(M.tag)){const A=M.tag;ke(A),z.delete(A)}n[a].tree=c,n[a].node=f}else{const f=Me(c);if(!f){u++;continue}if(r)x(e,f);else if(p(n)===0)o??(o=i.parentElement),o.insertBefore(f,i.nextSibling);else{const M=n[p(n)-1].node,A=M.nextSibling;M.parentElement.insertBefore(f,A)}n.push({key:u,tree:c,node:f})}u++}if(p(n)>p(s)){for(let c=p(s);c<p(n);c++){const a=n[c].tree;if(b(a.tag)&&Se(a.tag),n[c].node.remove(),b(a.tag)){const f=a.tag;ke(f),z.delete(f)}}n.splice(p(s),p(n)-p(s))}r=!1})}function F(e,t={},n=[""]){if(P(e)){const i=B(t,{children:n}),s=e(i);return J(s)}if(b(e)){if(e=e,Ne(e)){const u=new e({...t,children:n});return F(u.render.bind(u))}const i=B(t,{children:n}),s=e(i);return F(s.tag,s.attrs,s.children)}let r="";for(const i in t){if(i.startsWith("on")||i==="ref")continue;let s=m(t[i])&&Ce(i)?t[i]():t[i];if(O(e)&&["innerHTML","innerText"].includes(i)){n=[s];continue}if(i==="className"){s&&(r+=` class="${$e(...[s].flat())}"`);continue}if(i==="style"&&R(s)){for(const u in s)m(s[u])&&(s[u]=s[u]());s='"'+JSON.stringify(s).slice(1,-1).replace(/"/g,"").replace(/,/g,";")+'"'}r+=` ${i}="${s}"`}const o=J(n);return`<${e}${r}>${o}</${e}>`}function J(e){let t="";return d(e,n=>{if(N(n)){t+=n.toString();return}if(Z(n)){t+=J(n);return}if(m(n)){const r=n();t+=J([r]);return}if(R(n)){t+=F(n.tag,n.attrs,n.children);return}L(`renderToString: 不支持 ${n} 值渲染`)}),t}const Ee=[];function st(){d(Ee,e=>e()),Ee.length=0}const se=[];let Le=!1;function it(e){if(!de){if(Le){H(e);return}se.push(e)}}function ct(){d(se,e=>e()),se.length=0,Le=!0}function St({tag:e,attrs:t,children:n}){const r=C(e,t,n);return st(),H(ct),r}function ut({tag:e,attrs:t,children:n}){we(!0);const r=F(e,t,n);return we(!1),r}function at(e){const t={};return e.replace(/([^?&=]+)=([^&]+)/g,(n,r,o)=>t[r]=o),t}function Q(e){const t=new URL("http://0.0.0.0"+e);return{fullPath:t.href.replace(t.origin,""),path:t.pathname,query:at(t.search),hash:t.hash,meta:{}}}function ft(e){let t="";for(const r in e.query)e.query[r]&&(t+=`${r}=${e.query[r]}&`);t=t?"?"+t.slice(0,-1):"";let n=e.hash?"#"+e.hash:"";return e.path+t+n}function q(e){return e.replace(/\/{1,}/g,"/")}function Ie(e,t){O(e)&&(g.mode==="history"&&(e=g.base+e),e=Q(e));for(const r in e)l[r]=e[r];const{fullPath:n}=l;fe()&&(g.mode==="history"?history[t==="push"?"pushState":"replaceState"]({},"",n):location.hash=n)}function Ae(e){Ie(e,"push")}function he(e){Ie(e,"replace")}function re(e){history.go(e)}function lt(){return{back:()=>re(-1),forward:()=>re(1),go:re,push:Ae,replace:he,options:g,currentRoute:le(l)}}function pt(){return l}const g={base:"",mode:"history",ssrDataKey:"g_initialProps"};let l=null;function dt(e){l=e}function xe(){const{origin:e,href:t,hash:n}=location;return g.mode==="hash"?n.replace("#",""):t.replace(e+g.base,"")}let W=null;function kt(e={}){if(Object.assign(g,e),fe()){const t=Q(xe());l=I(t),window.addEventListener("popstate",()=>{const n=Q(xe());for(const r in n)l[r]=n[r]})}return{...lt(),beforeEach(t){W=t}}}const k={currentTemplate:"",ssrData:{}};function Mt(e){}function De(e,t){t=t.replace(g.base,"");const n=e.find(c=>{const{path:a,exact:f}=c.attrs;return f===!1?(t+"/").startsWith(q(a+"/")):q(a)===t});if(!n)return;const{path:r,component:o,beforeEnter:i,meta:s,redirect:u}=n.attrs;return{path:q(r),component:o,meta:s,beforeEnter:i,redirect:u}}let E;const Te=[];function ht(e){const t=Qe();let n={};function r(i){const s=De(e.children,i);if(!s){n={},t.value=e.notFound;return}async function u(){if(s.component.prototype||(s.component=(await s.component()).default),t.value===s.component)return;n.path=s.path;const a=ce(s.component);if(a){const f=window[g.ssrDataKey];f&&n.path in f?(n.data=f[n.path],delete f[n.path]):n.data=await a(w(n))}t.value=s.component,n.meta=s.meta,l.meta=s.meta}if(s.redirect&&s.redirect!==l.fullPath){he(s.redirect),r(l.path);return}function c(a){a(le(l),E,()=>{E=w(l),i===l.path?u():r(l.path)})}if(W){c(W);return}if(s.beforeEnter){c(s.beforeEnter);return}E=w(l),u()}const o=Ze(()=>l.path,i=>{if(E){const s=E.path.split("/"),u=i.split("/");s[1]!==u[1]&&d(Te,c=>c())}r(i)},{immediate:!0});return e.prefix&&Te.push(o),y(T,null,()=>y(t.value,{...n}))}const _=I([]);function ie(e){const t=_.indexOf(e);_.splice(t,1)}let S=null;function qe(e){function t(u){let c=De(e.children,u);if(c.redirect&&c.redirect!==l.fullPath)return dt(Q(c.redirect)),t(l.path);function a(f){return S=`b_${me()}`,_.push(S),f(le(l),E,()=>{E=w(l),c.path!==l.path?qe(e):(D(S,c.component,{path:c.path,meta:c.meta}),ie(S))}),S}return W?a(W):c.beforeEnter?a(c.beforeEnter):c}let n=t(l.path);if(O(n))return y(T,null,n);if(!n){const u=e.notFound;return y(u||T,null)}n=n;let r=n.component;l.meta=n.meta;const o={path:n.path,meta:n.meta};S&&(D(S,r,o),ie(S));const i=`r_${me()}`;if(!r.prototype)return _.push(i),r().then(async u=>{r=u.default;const c=ce(r);c&&(o.data=await c(w(o)),k.ssrData[o.path]=o.data),D(i,r,o)}),y(T,null,i);const s=ce(r);return s?(_.push(i),s(w(o)).then(u=>{o.data=u,k.ssrData[o.path]=u,D(i,r,o)}),y(T,null,i)):y(r,{...o})}function Et(e){return d(e.children,t=>{e.prefix&&(t.attrs.path=q(e.prefix+t.attrs.path)),t.children=[t.attrs.component]}),fe()?y(ht,{...e}):y(qe,{...e})}function D(e,t,n){const r=ut(y(t,{...n}));ie(e);const o=k.currentTemplate.replace(e,r);k.currentTemplate=o}function ce(e){const{getInitialProps:t}=e.prototype;if(t&&m(t))return t}function xt(e){const{to:t,type:n,className:r,children:o,...i}=e,s=pt();O(t)||(e.to=ft(Object.assign({},s,t)));const u=g.mode==="hash"?`${g.base}#${e.to}`:g.base+e.to;function c(a){a.preventDefault(),n==="replace"?he(e.to):Ae(e.to)}return y("a",{className:()=>{const a=e.to+"/",f=s.path+"/";return[f.startsWith(a)&&"active",f===a&&"exact-active",r]},href:u,onclick:c,...i},o)}function Tt(e){const t=[];if(d(e.children,o=>{o.tag==="title"?t.push(new RegExp("<title")):o.tag==="meta"&&o.attrs.name&&t.push(new RegExp(`<meta name=("|')?${o.attrs.name}`))}),k.currentTemplate){const s=k.currentTemplate.match(/\<head\>(.*)\<\/head>/s)[1].trim().split(`
`).filter(c=>c.includes("<"));for(let c=0;c<p(s);c++){s[c]=s[c].trim();for(let a=0;a<p(t);a++)t[a].test(s[c])&&(s[c]="")}d(e.children,c=>{const a=F(c.tag,c.attrs,c.children);s.push(a)});const u=s.filter(c=>c).join(`
`);k.currentTemplate=k.currentTemplate.replace(/\<head\>.*\<\/head>/s,`<head>
${u}
</head>`)}let n=[],r=0;return it(()=>{const o=document.head,i=o.innerHTML.split(`
`).filter(c=>c.includes("<")),s=[];e:for(let c=0;c<p(t);c++)for(let a=c;a<p(i);a++)if(t[c].test(i[a])){s.push(c);continue e}d(s,c=>{n.push(o.children[c].cloneNode(!0)),o.children[c].remove()}),r=p(e.children);const u=te(e.children);o.insertBefore(u,o.children[0])}),tt(()=>{const o=document.head;for(let i=0;i<r;i++)o.children[0].remove();d(n,i=>{o.insertBefore(i,o.childNodes[0])})}),y(T,null)}const X=Symbol("action");function mt(e){return m(e)&&e.prototype[X]===X}class yt{constructor(t,n){h(this,"state");h(this,"actions");this.state=I(w(t)),this.actions={};for(const r in n){let i=function(...s){const u=n[r](...s);if(j(u)&&u[Symbol.toStringTag]==="Promise")u.then(c=>(o._merge(t),c));else return o._merge(t),u};const o=this;i.prototype[X]=X,o.actions[r]=i}Object.assign(this.state,this.actions);for(const r in this.actions)Object.defineProperty(this.state,r,{writable:!1})}_merge(t){const n=w(t),r=Object.keys(n);for(const o in n)this.state[o]=n[o];for(const o in this.state)mt(this.state[o])||!r.includes(o)&&delete this.state[o]}}const oe=new WeakMap;function jt(e,t){return()=>{if(!oe.has(e)){const n=new yt(e,t);oe.set(e,n.state)}return oe.get(e)}}export{T as F,Tt as H,xt as L,Et as R,Rt as a,Mt as b,jt as c,w as d,St as e,fe as f,tt as g,y as h,kt as i,it as o,Qe as r,Ze as w};

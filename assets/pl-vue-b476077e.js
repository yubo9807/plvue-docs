var Je=Object.defineProperty;var Qe=(e,r,t)=>r in e?Je(e,r,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[r]=t;var m=(e,r,t)=>(Qe(e,typeof r!="symbol"?r+"":r,t),t),Me=(e,r,t)=>{if(!r.has(e))throw TypeError("Cannot "+t)};var ue=(e,r,t)=>(Me(e,r,"read from private field"),t?t.call(e):r.get(e)),O=(e,r,t)=>{if(r.has(e))throw TypeError("Cannot add the same private member more than once");r instanceof WeakSet?r.add(e):r.set(e,t)};var P=(e,r,t)=>(Me(e,r,"access private method"),t);function Ce(){return Number((Math.random()+"").slice(2)).toString(32)}function D(...e){console.warn(...e)}function d(e){return e.length}function ye(e){return Object.prototype.toString.call(e).slice(8,-1).toLowerCase()}function Xe(e){return e.toString().slice(0,5)==="class"}function L(e){return["object","array"].includes(ye(e))}function Ze(e,r){return Object.prototype.hasOwnProperty.call(e,r)}function we(e,r){if(L(e)&&L(r)){const t=Object.keys(e),n=Object.keys(r);if(d(t)!==d(n))return!1;for(const s of t)if(!n.includes(s)||!we(e[s],r[s]))return!1;return!0}else return e===r}function ce(){return typeof window=="object"}function T(e){return ye(e)==="object"}function J(e){return Array.isArray(e)}function j(e){return typeof e=="string"}function w(e){return typeof e=="function"}function Q(e){Promise.resolve().then(e)}class N extends WeakMap{}function S(e,r={}){const t=new N,n=["null","regexp","date","weakset","weakmap"],s=Object.assign({function(o){const u=function(...i){return o.apply(this,i)};return u.prototype=c(o.prototype),u},set(o){const u=new Set;for(const i of o)u.add(c(i));return u},map(o){const u=new Map;for(const[i,a]of o.entries())u.set(i,c(a));return u}},r);function c(o){if(ce()&&o instanceof HTMLElement)return o.cloneNode(!0);const u=ye(o);if(!["object","function"].includes(typeof o)||n.includes(u))return o;if(t.has(o))return t.get(o);if(s[u])return s[u](o);const i=J(o)?[]:{};Object.setPrototypeOf(i,Object.getPrototypeOf(o)),t.set(o,i);for(const a in o)o.hasOwnProperty(a)&&(i[a]=c(o[a]));return i}return c(e)}function X(e,r){return Object.assign({},e,r)}function p(e,r,t){let n=0;for(;n<e.length;){if(e.hasOwnProperty(n)){const s=e[n];r.apply(t,[s,n,t])}n++}}let H=null;const Z=new N;function z(e){H=e,e(),H=null}function ve(e){const r=Z.get(e)||[],t=r.some(n=>H===n);H&&!t&&(r.push(H),Z.set(e,r))}function Ne(e){const r=Z.get(e);r&&p(r,(t,n)=>{t()===!0&&(r.splice(n,1),Z.set(e,r))})}const et=new N,ae=new N,v={RAW:Symbol("__v_raw"),IS_READONLY:Symbol("__v_isReadonly")};function U(e){if(!L(e)||Object.isFrozen(e))return D(`lue cannot be made reactive: ${e}`),e;if(et.get(e))return e;let r=null;return new Proxy(e,{get(t,n,s){if(n===v.RAW)return t;const c=Reflect.get(t,n,s);return ve(t),L(c)?U(c):c},set(t,n,s,c){if(t[v.IS_READONLY]||Reflect.get(t,n,c)===s)return!0;const u=Reflect.set(t,n,s,c),i=ae.get(t)||new Set;i.add(n);const a=i.size;return ae.set(t,i),Q(()=>{u&&a===1&&Ne(t),ae.delete(t)}),u},deleteProperty(t,n){const s=Reflect.get(t,n),c=Ze(t,n),o=Reflect.deleteProperty(t,n);return r=n,Q(()=>{c&&o&&s!==void 0&&n===r&&(Ne(t),r=null)}),o}})}function tt(e){return T(e)&&!!e[v.RAW]}function be(e){return tt(e)?e[v.RAW]:e}function nt(e){const r={value:e},t=U(r);function n(){return t.value}function s(c){t.value=c}return[n,s,r]}const _e=Symbol("__v_isRef");var Nt;class rt{constructor(r){m(this,Nt,!0);m(this,"_rawValue");m(this,"_value");m(this,"getSignal");m(this,"setSignal");const[t,n,s]=nt(r);this._rawValue=s,this.getSignal=t,this.setSignal=n,this._value=t()}get value(){return this.getSignal()}set value(r){this.setSignal(r)}}Nt=_e;function st(e=void 0){return new rt(e)}class ot{constructor(r){m(this,"fn");this.fn=r}}var kt;class ke{constructor(r,t){m(this,"__v_isReadonly",!0);m(this,kt,!0);m(this,"_cacheable",!0);m(this,"_dirty",!0);m(this,"computed");m(this,"_setter");this.computed=new ot(r),this._setter=t}get value(){return this.computed.fn()}set value(r){this._setter?this._setter(r):D("Write operation failed: computed value is readonly")}}kt=_e;function Et(e){return w(e)?new ke(e):new ke(e.get,e.set)}function it(e,r,t={}){let n=!1;if(n)return;const s=e();t.immediate&&r(s,void 0);let c=S(s),o=!0;return z(()=>{if(n)return!0;const u=e();if(L(u)){t.deep&&!we(u,c)&&(r(u,c),c=S(u));return}if(o){o=!1;return}u!==c&&(r(u,c),c=u)}),()=>{n=!0}}function F(e){return["string","number"].includes(typeof e)&&e!==""}function Ae(e){return!/^on/.test(e)}function ct(e){return T(e)&&j(e.tag)}function R(e){return w(e)&&!_(e)}function Ie(e){return Xe(e)&&e.prototype&&e.prototype.render}function xe(e){return[void 0,null,"",!0,!1].includes(e)}function De(...e){return e.filter(t=>F(t)).join(" ").trim().replace(/\s+/," ")}function le(e){return document.createTextNode(e)}function $(e,r){e.appendChild(r)}function y(e,r,...t){const n={tag:e,attrs:r||{},children:t};return R(n.tag)&&d(n.children)===0&&n.attrs.children&&(n.children=n.attrs.children),n}function E({children:e}){return e}const ee=Symbol("Fragment");E.prototype[ee]=ee;function _(e){return w(e)&&e.prototype&&e.prototype[ee]===ee}const Y=new N;function We(e,r=[]){return p(e,t=>{T(t)&&(R(t.tag)?(r.push({comp:t.tag,props:X(t.attrs,{children:e})}),p(t.children,n=>{R(n)&&r.push({comp:n,props:{}})})):F(t.tag)&&We(t.children,r))}),r}function Re(e,r=[]){const t=Y.get(e)||[];return r.push(...t),p(t,n=>{const s=Re(n.comp);r.push(...s)}),r}let te=null;function ut(e){te=e}let Ee=null;function at(e,r){te=e,"ref"in r&&(r.ref.value=Ee),Ee=null}let Se=!1;function je(e){Se=e}const Fe=[];function lt(){p(Fe,e=>e()),Fe.length=0}const de=[];let qe=!1;function ft(e){if(!Se){if(qe){Q(e);return}de.push(e)}}function ht(){p(de,e=>e()),de.length=0,qe=!0}const Le=new N;function Oe(e){const r=Re(e).map(n=>n.comp);r.unshift(e);const t=[];p(r,n=>{const s=Le.get(n)||[];t.push(...s),Le.delete(n)}),p(t,n=>n())}const ne=new N;function dt(e){if(Se)return;const r=ne.get(te)||[];r.some(n=>n===e)||(r.push(e),ne.set(te,r))}function Pe(e){const r=Re(e).map(n=>n.comp);r.unshift(e);const t=[];p(r,n=>{const s=ne.get(n)||[];t.push(...s),ne.delete(n)}),p(t,n=>n())}class pt{constructor(r){m(this,"config");this.config=r}intercept(r){return r}renderToString(r){je(!0);const t=this.createHTML(r);return je(!1),t}createHTML(r){const{tag:t,attrs:n,children:s}=this.intercept(r);if(_(t)){const u=X(n,{children:s}),i=t(u);return this.createHTMLFragment(i)}if(R(t)){if(Ie(t)){const a=new t({...n,children:s});return this.createHTML(a.render.bind(a))}const u=X(n,{children:s}),i=t(u);return this.createHTML(i)}let c="";for(const u in n){if(u.startsWith("on")||["ref","created"].includes(u))continue;let i=w(n[u])&&Ae(u)?n[u]():n[u];if(j(t)&&["innerHTML","innerText","textContent"].includes(u)){s[0]=i;continue}if(u==="className"){i&&(c+=` class="${De(...[i].flat())}"`);continue}if(u==="style"&&T(i)){for(const a in i)w(i[a])&&(i[a]=i[a]());i='"'+JSON.stringify(i).slice(1,-1).replace(/"/g,"").replace(/,/g,";")+'"'}c+=` ${u}="${i}"`}const o=this.createHTMLFragment(s);return`<${t}${c}>${o}</${t}>`}createHTMLFragment(r){let t="";return p(r,n=>{if(F(n)){t+=n.toString();return}if(J(n)){t+=this.createHTMLFragment(n);return}if(w(n)){const s=n();t+=this.createHTMLFragment([s]);return}if(T(n)){t+=this.createHTML(n);return}D(`renderToString: 不支持 ${n} 值渲染`)}),t}}var q,pe,oe,Be,ie,Ue;class mt extends pt{constructor(t){super(t);O(this,q);O(this,oe);O(this,ie)}render(t){const n=this.createElement(t);return lt(),Q(ht),n}createElement(t){const{tag:n,attrs:s,children:c}=this.intercept(t);if(j(n))return this.createRealNode(n,s,c);if(_(n))return this.createNodeFragment(c);if(R(n))return this.createComponent(n,s,c)}createComponent(t,n,s){if(ut(t),Ie(t)){const u=new t({...n,children:s});t=u.render.bind(u)}const c=X(n,{children:s}),o=t(c);return at(t,n),F(o)?le(o):(Y.set(t,We([o,...o.children])),this.createElement(o))}createRealNode(t,n={},s=[""]){const c=document.createElement(t);p(s,o=>{if(this.intercept(o),w(o)){const u=this.createNodeFragment([o]);$(c,u)}else P(this,q,pe).call(this,c,o)});for(const o in n)P(this,oe,Be).call(this,c,o,n[o]);if(n.style&&T(n.style))for(const o in n.style){const u=n.style[o];w(u)?z(()=>c.style[o]=u()):c.style[o]=u}return c}createNodeFragment(t){const n=document.createDocumentFragment();return p(t,s=>{this.intercept(s),w(s)?P(this,ie,Ue).call(this,n,s):P(this,q,pe).call(this,n,s)}),n}createNode(t){if(F(t))return le(t);if(ct(t))return this.createRealNode(t.tag,t.attrs,t.children);if(_(t.tag))return this.createNodeFragment(t.children);if(R(t.tag))return this.createComponent(t.tag,t.attrs,t.children)}}q=new WeakSet,pe=function(t,n){if(!xe(n)){if(J(n)){const s=this.createNodeFragment(n);$(t,s);return}if(F(n)||T(n)){const s=this.createNode(n);$(t,s);return}D(`render: 不支持 ${n} 值渲染`)}},oe=new WeakSet,Be=function(t,n,s){if(n==="ref"&&T(s)){s.value=t;return}if(n==="created"&&w(s)){s(t);return}let c=o=>t[n]=o;n==="className"?c=o=>t[n]=De(...[o].flat()):n.startsWith("data-")&&(c=o=>t.dataset[n.slice(5)]=o),Ae(n)&&w(s)?z(()=>c(s())):c(s)},ie=new WeakSet,Ue=function(t,n){let s=[],c=!0,o=null;const u=le("");$(t,u),z(()=>{let i=n();if(i&&T(i)&&_(i.tag)){D("不支持响应式节点片段渲染");return}J(i)||(i=[i]),i=i.filter(l=>!xe(l));let a=0;for(;a<d(i);){let l=i[a];const h=gt(s,a);if(h>=0){if(we(l,s[h].tree)){a++;continue}const g=this.createNode(l);if(!g){i.splice(h,1),a++;continue}const k=s[h].tree;if(R(k.tag)&&Oe(k.tag),s[h].node.parentElement.replaceChild(g,s[h].node),R(k.tag)){const V=k.tag;Pe(V),Y.delete(V)}s[h].tree=l,s[h].node=g}else{const g=this.createNode(l);if(!g){a++;continue}if(c)$(t,g);else if(d(s)===0)o??(o=u.parentElement),o.insertBefore(g,u.nextSibling);else{const k=s[d(s)-1].node,V=k.nextSibling;k.parentElement.insertBefore(g,V)}s.push({key:a,tree:l,node:g})}a++}if(d(s)>d(i)){for(let l=d(i);l<d(s);l++){const h=s[l].tree;if(R(h.tag)&&Oe(h.tag),s[l].node.remove(),R(h.tag)){const g=h.tag;Pe(g),Y.delete(g)}}s.splice(d(i),d(s)-d(i))}c=!1})};function gt(e,r){let t=0,n=d(e)-1;for(;t<=n;){const s=Math.ceil((t+n)/2),c=e[s];if(r===c.key)return s;r<c.key?n=s-1:r>c.key&&(t=s+1)}return-1}var B;class yt extends mt{constructor(t){super(t);m(this,"version","0.6.4");O(this,B,new Map);this.config=t}use(t){return t.install(this),this}intercept(t){if(t&&j(t.tag)){const n=ue(this,B).get(t.tag);n&&(t.tag=n)}return t}component(t,n){return ue(this,B).set(t,n),this}}B=new WeakMap;function jt(e={}){return new yt(e)}function wt(e){const r={};return e.replace(/([^?&=]+)=([^&]+)/g,(t,n,s)=>r[n]=s),r}function A(e){const r=new URL("http://0.0.0.0"+e);return{fullPath:r.href.replace(r.origin,""),path:r.pathname,query:wt(r.search),hash:r.hash,meta:{}}}function bt(e){let r="";for(const n in e.query)e.query[n]&&(r+=`${n}=${e.query[n]}&`);r=r?"?"+r.slice(0,-1):"";let t=e.hash?"#"+e.hash:"";return e.path+r+t}function G(e){return e.replace(/\/{1,}/g,"/")}function Ve(e,r){j(e)&&(b.mode==="history"&&(e=b.base+e),e=A(e));for(const n in e)f[n]=e[n];const{fullPath:t}=f;ce()&&(b.mode==="history"?history[r==="push"?"pushState":"replaceState"]({},"",t):location.hash=t)}function Ke(e){Ve(e,"push")}function Te(e){Ve(e,"replace")}function fe(e){history.go(e)}function Rt(){return{back:()=>fe(-1),forward:()=>fe(1),go:fe,push:Ke,replace:Te,options:b,currentRoute:be(f)}}function ze(){return f}const b={base:"",mode:"history",ssrDataKey:"g_initialProps"};let re=null,f=null;function St(e){f=e}function $e(){const{origin:e,href:r,hash:t}=location;return b.mode==="hash"?t.replace("#",""):r.replace(e+b.base,"")}let W=null;function Ft(e={}){if(Object.assign(b,e),ce()){const t=A($e());f=U(t),window.addEventListener("popstate",()=>{const n=A($e());for(const s in n)f[s]=n[s]})}else f=A("");const r=Rt();return{install(t){re=t,t.$router=r,t.$route=ze()},...r,beforeEach(t){W=t}}}const C={currentTemplate:"",ssrData:{}};function Lt(e){}function Ye(e,r){r=r.replace(b.base,"");const t=e.find(i=>{const{path:a,exact:l}=i.attrs;return l===!1?(r+"/").startsWith(G(a+"/")):G(a)===r});if(!t)return;const{path:n,component:s,beforeEnter:c,meta:o,redirect:u}=t.attrs;return{path:G(n),component:s,meta:o,beforeEnter:c,redirect:u}}let x;const He=[];function Tt(e){const r=st(e.loading);let t={};function n(c){const o=Ye(e.children,c);if(!o){t={},r.value=e.notFound;return}async function u(){if(o.component.prototype||(o.component=(await o.component()).default),r.value===o.component)return;t.path=o.path;const a=ge(o.component);if(a){const l=window[b.ssrDataKey];l&&t.path in l?(t.data=l[t.path],delete l[t.path]):t.data=await a(S(t))}r.value=o.component,t.meta=o.meta,f.meta=o.meta}if(o.redirect&&o.redirect!==f.fullPath){Te(o.redirect),n(f.path);return}function i(a){a(be(f),x,()=>{x=S(f),c===f.path?u():n(f.path)})}if(W){i(W);return}if(o.beforeEnter){i(o.beforeEnter);return}x=S(f),u()}const s=it(()=>f.path,c=>{if(x){const o=x.path.split("/"),u=c.split("/");o[1]!==u[1]&&p(He,i=>i())}n(c)},{immediate:!0});return e.prefix&&He.push(s),y(E,null,()=>y(r.value,{...t}))}const I=U([]);function me(e){const r=I.indexOf(e);I.splice(r,1)}let M=null;function Ge(e){function r(u){let i=Ye(e.children,u);if(i.redirect&&i.redirect!==f.fullPath)return St(A(i.redirect)),r(f.path);function a(l){return M=`b_${Ce()}`,I.push(M),l(be(f),x,()=>{x=S(f),i.path!==f.path?Ge(e):(K(M,i.component,{path:i.path,meta:i.meta}),me(M))}),M}return W?a(W):i.beforeEnter?a(i.beforeEnter):i}let t=r(f.path);if(j(t))return y(E,null,t);if(!t){const u=e.notFound;return y(u||E,null)}t=t;let n=t.component;f.meta=t.meta;const s={path:t.path,meta:t.meta};M&&(K(M,n,s),me(M));const c=`r_${Ce()}`;if(!n.prototype)return I.push(c),n().then(async u=>{n=u.default;const i=ge(n);i&&(s.data=await i(S(s)),C.ssrData[s.path]=s.data),K(c,n,s)}),y(E,null,c);const o=ge(n);return o?(I.push(c),o(S(s)).then(u=>{s.data=u,C.ssrData[s.path]=u,K(c,n,s)}),y(E,null,c)):y(n,{...s})}function Ot(e){return p(e.children,r=>{e.prefix&&(r.attrs.path=G(e.prefix+r.attrs.path)),r.children=[r.attrs.component]}),ce()?y(Tt,{...e}):y(Ge,{...e})}function K(e,r,t){const n=re.renderToString(y(r,{...t}));me(e);const s=C.currentTemplate.replace(e,n);C.currentTemplate=s}function ge(e){const{getInitialProps:r}=e.prototype;if(r&&w(r))return r}function Pt(e){const{to:r,type:t,className:n,children:s,onClick:c,...o}=e,u=ze();j(r)||(e.to=bt(Object.assign({},u,r)));const i=b.mode==="hash"?`${b.base}#${e.to}`:b.base+e.to;function a(l){l.preventDefault();function h(g=e.to){t==="replace"?Te(g):Ke(g)}c?c(e.to,h):h()}return y("a",{className:()=>{const l=e.to+"/",h=u.path+"/";return[h.startsWith(l)&&"active",h===l&&"exact-active",n]},href:i,onclick:a,...o},s)}function $t(e){const r=[];if(p(e.children,s=>{s.tag==="title"?r.push(new RegExp("<title")):s.tag==="meta"&&s.attrs.name&&r.push(new RegExp(`<meta name=("|')?${s.attrs.name}`))}),C.currentTemplate){const o=C.currentTemplate.match(/\<head\>(.*)\<\/head>/s)[1].trim().split(`
`).filter(i=>i.includes("<"));for(let i=0;i<d(o);i++){o[i]=o[i].trim();for(let a=0;a<d(r);a++)r[a].test(o[i])&&(o[i]="")}p(e.children,i=>{const a=re.createHTML(i);o.push(a)});const u=o.filter(i=>i).join(`
`);C.currentTemplate=C.currentTemplate.replace(/\<head\>.*\<\/head>/s,`<head>
${u}
</head>`)}let t=[],n=0;return ft(()=>{const s=document.head,c=s.innerHTML.split(`
`).filter(i=>i.includes("<")),o=[];e:for(let i=0;i<d(r);i++)for(let a=i;a<d(c);a++)if(r[i].test(c[a])){o.push(i);continue e}p(o,i=>{t.push(s.children[i].cloneNode(!0)),s.children[i].remove()}),n=d(e.children);const u=re.createNodeFragment(e.children);s.insertBefore(u,s.children[0])}),dt(()=>{const s=document.head;for(let c=0;c<n;c++)s.children[0].remove();p(t,c=>{s.insertBefore(c,s.childNodes[0])})}),y(E,null)}const se=Symbol("action");function Mt(e){return w(e)&&e.prototype[se]===se}class Ct{constructor(r,t){m(this,"state");m(this,"actions");this.state=U(S(r)),this.actions={};for(const n in t){let c=function(...o){const u=t[n].bind(r)(...o);if(L(u)&&u[Symbol.toStringTag]==="Promise")u.then(i=>(s._merge(r),i));else return s._merge(r),u};const s=this;c.prototype[se]=se,s.actions[n]=c}Object.assign(this.state,this.actions);for(const n in this.actions)Object.defineProperty(this.state,n,{writable:!1})}_merge(r){const t=S(r),n=Object.keys(t);for(const s in t)this.state[s]=t[s];for(const s in this.state)Mt(this.state[s])||!n.includes(s)&&delete this.state[s]}}const he=new N;function Ht(e){const{id:r,state:t,actions:n}=e;return()=>{if(!he.has(t)){const s=new Ct(t,n);he.set(t,s.state)}return he.get(t)}}export{E as F,$t as H,Pt as L,Ot as R,jt as a,Et as b,Ft as c,Ht as d,S as e,Lt as f,dt as g,y as h,ce as i,ft as o,st as r,it as w};
